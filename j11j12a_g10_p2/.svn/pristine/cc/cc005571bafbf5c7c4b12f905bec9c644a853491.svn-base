#include <stdio.h>
#include <stdlib.h>

void insert_clave(char *clave);
int contar_palabras(char *fichero);
long dividir(int divisor, char *fichero);


int main(int argc, char * argv[]){
  int reventadores;
  long octeto_ini = 0;
  long octeto_end;

  sscanf(argv[3],"%d", &reventadores);

  if(argc == 6){
    insert_clave(argv[1]);
    for(int i = 1; i < reventadores; i++){
      octeto_end = dividir(i * contar_palabras(argv[2])/reventadores, argv[2]);
      printf("reventador words %ld %ld %s clave\n",octeto_ini, octeto_end, argv[1]);
      octeto_ini = octeto_end + 1;
    }
    printf("reventador words %ld %d %s clave\n",octeto_ini, contar_palabras(argv[2]), argv[1]);
  }else{
    printf("Argumentos mal introducidos");
  }
}

void insert_clave(char *clave){
  FILE *fich;
  fich = fopen("clave.txt", "w");
  if(fich){
    fprintf(fich,"%s",clave);
  }else{
    printf("no su pudo abrir el cichero clave.txt");
  }
  fclose(fich);
}

int contar_palabras(char *fichero){
  int count = 0;
  char aux[80] ;
  FILE *fich;
  fich = fopen(fichero, "r");

  if(fich){
    while(fscanf(fich, "%c", aux) != EOF){
      count++;
    }
  }else{
    printf("no su pudo abrir el diccionario");
  }
  return count;
}

long dividir(int divisor, char *fichero){
  FILE *fich;
  fich = fopen(fichero, "r");

  if(fich){
    fseek(fich, divisor, SEEK_SET);
    while(fgetc(fich) != '\n'){

    }

  }else{
    printf("no su pudo abrir el diccionario");
  }
  return ftell(fich);
}
